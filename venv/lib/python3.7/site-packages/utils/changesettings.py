from redbot.core import commands as cmd
from discord import Embed
from utils.imports import TextChannelConverter, COLOR, RoleConverter

async def change_reference(ctx: cmd.Context, reference, config, ref_type):
    if ref_type == "Channel":
        ref = await TextChannelConverter().convert_(ctx, reference)
    elif ref_type == "Role":
        ref = await RoleConverter().convert_(ctx, reference)

    if ref is None:
        embed = Embed(
            title="Error",
            color=COLOR,
            description="{} reference not found.".format(ref_type)
        )
    else:
        await config.set(ref.id)
        embed = Embed(
            title="{} changed".format(ref_type),
            color=COLOR,
            description=str(ref)
        )

    await ctx.send(embed=embed)

async def change_data(ctx: cmd.Context, text, change_type):
    text = text.replace("\\n", "\n")

    try:
        embed = Embed(
            title="Message changed - example:",
            color=COLOR,
            description=text.format(ctx.author)
        )
        await change_type.set(text)

    except AttributeError:
        embed = Embed(
            title="Error",
            color=COLOR,
            description="Wrong attribute."
        )
    except IndexError:
        embed = Embed(
            title="Error",
            color=COLOR,
            description="Wrong format."
        )

    finally:
        await ctx.send(embed=embed)