from redbot.core import commands as cmd
from discord import Embed
from utils.imports import TextChannelConverter, COLOR

async def change_channel(ctx: cmd.Context, channel, config):
    channel = await TextChannelConverter().convert_(ctx, channel)

    if channel is None:
        embed = Embed(
            title="Error",
            color=COLOR,
            description="Channel reference not found."
        )
    else:
        await config.set(channel.id)
        embed = Embed(
            title="Channel changed",
            color=COLOR,
            description=str(channel)
        )

    await ctx.send(embed=embed)

async def change_data(ctx: cmd.Context, text, change_type):
    text = text.replace("\\n", "\n")

    try:
        embed = Embed(
            title="Message changed - example:",
            color=COLOR,
            description=text.format(ctx.author)
        )
        await change_type.set(text)

    except AttributeError:
        embed = Embed(
            title="Error",
            color=COLOR,
            description="Wrong attribute."
        )
    except IndexError:
        embed = Embed(
            title="Error",
            color=COLOR,
            description="Wrong format."
        )

    finally:
        await ctx.send(embed=embed)